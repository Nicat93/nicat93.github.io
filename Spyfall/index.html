<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spyfall</title>
    <style>
        :root {
            --primary-color: #00ff00;
            --background-color: #121212;
            --accent-color: #1a1a1a;
            --text-color: #e0e0e0;
        }

        body {
            background-color: var(--background-color);
            color: var(--text-color);
            text-align: center;
            padding: 20px;
            line-height: 1.6;
            margin: 0;
        }

        .screen {
            display: none;
            border: 2px solid var(--primary-color);
            border-radius: 10px;
            padding: 20px;
            max-width: 600px;
            margin: 20px auto;
            background: var(--accent-color);
        }

        .visible { display: block; }

        button {
            background: linear-gradient(145deg, #121212, #1a1a1a);
            color: var(--primary-color);
            border: 2px solid var(--primary-color);
            padding: 12px 25px;
            margin: 10px;
            cursor: pointer;
            border-radius: 5px;
            transition: all 0.3s ease;
            text-transform: uppercase;
        }

        button:hover {
            background: var(--primary-color);
            color: var(--background-color);
            box-shadow: 0 0 15px rgba(0, 255, 0, 0.3);
        }

        .player-container {
            display: flex;
            justify-content: center;
            margin: 10px;
            gap: 10px;
        }

        .player-input {
            padding: 8px 12px;
            width: 200px;
            background: var(--accent-color);
            border: 1px solid var(--primary-color);
            border-radius: 5px;
            color: var(--text-color);
        }

        .remove-btn {
            padding: 5px 12px;
            background: #ff4444;
            border: none;
            border-radius: 5px;
            color: white;
            cursor: pointer;
        }

        .remove-btn:hover { background: #ff0000; }

        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            display: none;
            justify-content: center;
            align-items: center;
        }

        .role-config {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin: 20px 0;
        }

        .role-config label {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            background: #1a1a1a;
            border-radius: 5px;
        }

        .counter {
            display: flex;
            gap: 5px;
            align-items: center;
        }

        .role-input {
            width: 60px;
            padding: 5px;
            text-align: center;
            background: var(--accent-color);
            border: 1px solid var(--primary-color);
            color: var(--text-color);
        }

        h1, h2 { color: var(--primary-color); }

        #overlayContent {
            background: var(--accent-color);
            padding: 30px;
            border-radius: 10px;
            border: 2px solid var(--primary-color);
            max-width: 500px;
            text-align: left;
        }

        .glow-text {
            animation: glow 2s infinite;
        }

        @keyframes glow {
            0%, 100% { text-shadow: 0 0 5px var(--primary-color); }
            50% { text-shadow: 0 0 20px var(--primary-color); }
        }
    </style>
</head>
<body>
    <div id="setup" class="screen visible">
        <h1 class="glow-text">üïµÔ∏è Spyfall</h1>
        <div id="playerConfig">
            <div class="role-config">
                <label>
                    <span>C…ôsus:</span>
                    <div class="counter">
                        <button class="count-btn minus">-</button>
                        <input type="number" id="spyCount" class="role-input" min="1" value="1">
                        <button class="count-btn plus">+</button>
                    </div>
                </label>
                <label>
                    <span>Joker:</span>
                    <div class="counter">
                        <button class="count-btn minus">-</button>
                        <input type="number" id="jokerCount" class="role-input" min="0" value="0">
                        <button class="count-btn plus">+</button>
                    </div>
                </label>
                <label>
                    <span>X…ôfiyy…ô:</span>
                    <div class="counter">
                        <button class="count-btn minus">-</button>
                        <input type="number" id="detectiveCount" class="role-input" min="0" value="0">
                        <button class="count-btn plus">+</button>
                    </div>
                </label>
            </div>
            <div id="nameInputs">
                <!-- players -->
            </div>
            <button onclick="addPlayer()">Oyun√ßu ∆èlav…ô Et</button>
        </div>
        <button onclick="startGame()">Oyunu Ba≈ülat</button>
    </div>

    <div id="roleScreen" class="screen">
        <h2><span id="currentPlayerName" class="glow-text">Oyun√ßu</span></h2>
        <button onclick="showRole()">Rolu g√∂st…ôr</button>
        <button onclick="nextPlayer()" style="display:none;" id="nextBtn">N√∂vb…ôti Oyun√ßu</button>
    </div>

    <div id="gameScreen" class="screen">
        <h2 class="glow-text">Oyun Davam Edir!</h2>
        <button onclick="accuse()">Oyun√ßunu ƒ∞tham Et</button>
        <button onclick="guessLocation()">M…ôkanƒ± T…ôxmin Et (Casus)</button>
    </div>

    <div id="roleOverlay" class="overlay">
        <div id="overlayContent"></div>
        <button onclick="hideOverlay()">Geri</button>
    </div>

    <script>
        const locations = {
            "Bank": ["Kassir", "T…ôhl√ºk…ôsizlik", "M√º≈üt…ôri", "Menecer", "T…ômizlik√ßi"],
            "X…ôst…ôxana": ["H…ôkim", "Tibb bacƒ±sƒ±", "X…ôst…ô", "Ziyar…ôt√ßi", "T…ôcili yardƒ±m i≈ü√ßisi"],
            "Kosmik Stansiya": ["Komandir", "M√ºh…ôndis", "Alim", "H…ôkim", "Yad planetli S…ôfir"],
            "Film Studiyasƒ±": ["Rejissor", "Aktyor", "Kamera operatoru", "Dublyor", "Geyim Dizayneri"],
            "Quldur G…ômisi": ["Kapitan", "Birinci K√∂m…ôk√ßi", "Naviqator", "A≈üpaz", "M…ôhbus"],
            "Laboratoriya": ["Ba≈ü Alim", "Laborant", "T…ôhl√ºk…ôsizlik r…ôisi", "T…ômizlik√ßi", "Stajor"],
            "Gece Klubu": ["DJ", "T…ôhl√ºk…ôsizlik", "Barmen", "R…ôqqas…ô", "VIP Qonaq"],
            "Q√ºtb Stansiyasƒ±": ["Ekspedisiya r…ôhb…ôri", "Meteoroloq", "H…ôkim", "A≈üpaz", "Pilot"],
            "Sirk √áadƒ±rƒ±": ["≈ûoumen", "Akrobat", "Kloun", "Heyvan M…ô≈üq√ßisi", "Bilet Satƒ±cƒ±sƒ±"],
            "Sualtƒ± g…ômi": ["Kapitan", "Sonar Texniki", "M√ºh…ôndis", "A≈üpaz", "D…ôniz Bioloqu"],
            "ƒ∞nc…ôs…ôn…ôt Qalereyasƒ±": ["Kurator", "R…ôssam", "T…ôhl√ºk…ôsizlik", "ƒ∞nc…ôs…ôn…ôt T…ônqid√ßisi", "Ziyar…ôt√ßi"],
            "Musiqi Festivalƒ±": ["Vokalist", "Gitara√ßƒ±", "Texnik", "T…ôhl√ºk…ôsizlik", "Yem…ôk Satƒ±cƒ±sƒ±"],
            "Wild West Bar": ["≈ûerif", "Barmen", "Qumar Oyun√ßusu", "Piano√ßu", "Qanunq…ôza"],
            "Hava Limanƒ±": ["Pilot", "Stuardessa", "T…ôhl√ºk…ôsizlik", "S…ôrni≈üin", "T…ômizlik√ßi"],
            "H…ôrbi Baza": ["General", "Snayper", "H…ôkim", "M√ºh…ôndis", "∆èsg…ôr"],
            "√úz√ºm ≈û…ôrab Baƒüƒ±": ["≈û…ôrab√ßƒ±", "Ekskursiya R…ôhb…ôri", "Yƒ±ƒüƒ±m√ßƒ±", "Dadƒ±cƒ±"],
            "Kino Teatr": ["Proyeksionist", "B√ºfet√ßi", "T…ômizlik√ßi", "ƒ∞zl…ôyici"],
            "Zoopark": ["Heyvan Baxƒ±cƒ±sƒ±", "Veterinar", "Ekskursiya R…ôhb…ôri", "Ziyar…ôt√ßi", "Heyvan M…ô≈üq√ßisi"],
            "Kils…ô": ["Ke≈üi≈ü", "Xor m√ºƒü…ônnisi", "T…ômizlik√ßi", "Ekskursiya R…ôhb…ôri", "Dindar"],
            "Ma≈üƒ±n Yarƒ±≈ü Meydanƒ±": ["S√ºr√ºc√º", "Mexanik", "≈û…ôrh√ßi", "Tama≈üa√ßƒ±", "H…ôkim"],
            "Xiz…ôk Kurortu": ["T…ôlimat√ßƒ±", "Lift Operatoru", "Xilasedici", "Turist", "Barmen"],
            "UFO Q…ôza Yeri": ["Yadplanetli", "Alim", "H…ôrbi Polis", "Konspirasiya N…ôz…ôriyy…ô√ßisi", "M√ºxbir"],
            "Q…ôdim M…ôb…ôd": ["Kahin", "S…ôfir", "T…ôhl√ºk…ôsizlik", "Arxeoloq", "K…ôndli"],
            "Sualtƒ± ≈û…ôh…ôr": ["D…ôniz Biologu", "Sualtƒ± M√ºh…ôndisi", "Dalƒüƒ±√ß", "≈û…ôh…ôr R…ôhb…ôri", "S…ôyah…ôt√ßi"],
            "Gizli Bunker": ["H…ôrbi R…ôhb…ôr", "≈ûifr…ô√ßi", "T…ôchizat√ßƒ±", "M√ºh…ôndis", "Casus"],
            "Qƒ±z Qalasƒ±": ["Kral", "C…ôngav…ôr", "Zindancƒ±", "A≈üpaz", "Saray C…ôlladƒ±"],
            "Kosmos Koloniyasƒ±": ["Koloniya R…ôhb…ôri", "T…ômir√ßi", "Botanik", "Astronavt", "M…ôd…ôn√ßi"],
            "Maƒüara": ["S…ôyyah", "Daƒü√ßƒ±", "Paleontoloq", "Rehber", "X…ôzin…ô Axtaran"],
            "Robot Zavodu": ["Ba≈ü M√ºh…ôndis", "Robot Texniki", "Keyfiyy…ôt N…ôzar…ôt√ßisi", "T…ôhl√ºk…ôsizlik", "S…ôyyar Satƒ±cƒ±"],
            "≈ûirniyyat Fabriki": ["≈ûirniyyat Ustasƒ±", "Qabla≈üdƒ±rƒ±cƒ±", "Dadƒ±cƒ±", "Anbar√ßƒ±", "Satƒ±cƒ±"],
            "Vampir Q…ôsri": ["Vampir", "Vampir Ov√ßusu", "Xidm…ôt√ßi", "Tarix√ßi", "Qonaq"],
            "Dinozavr Parkƒ±": ["Paleontoloq", "Tur Rehberi", "Veterinar", "T…ôhl√ºk…ôsizlik", "Fotoreporter"],
            "M…ôkt…ôb": ["Direktor", "M√º…ôllim", "T…ôl…ôb…ô", "Baxƒ±cƒ±", "Psixoloq"],
            "Laboratoriya": ["Labarant", "T…ôcr√ºb…ô K√∂m…ôk√ßisi", "Kitabxana√ßƒ±", "G√∂z…ôt√ßi"],
            "S…ôhra": ["B…ôd…ôvi", "Su M√ºh…ôndisi", "Ticar…ôt√ßi", "Ziyar…ôt√ßi", "X…ôzin…ô Ov√ßusu"],
            "Muzey": ["Kurator", "Arxeoloq", "T…ôhl√ºk…ôsizlik", "Ziyar…ôt√ßi", "M√º…ôllim"],
            "≈ûahmat Turniri": ["Qrossmeyster", "Hakim", "K√∂n√ºll√º", "Jurnalist", "Sponsor"],
            "Komputer Zalƒ±": ["Hacker", "E-ƒ∞dman Oyun√ßusu", "VR T…ôrtibat√ßƒ±", "Barista", "M√º≈üt…ôri"],
            "Dinozavr Muzeyi": ["Eksponat B…ôrpa√ßƒ±", "Qidalandƒ±rƒ±cƒ±", "Tur Rehberi", "T…ôhl√ºk…ôsizlik", "Paleontoloq"],
            "Neft Da≈ülarƒ±": ["Neft√ßi", "D…ôniz M√ºh…ôndisi", "Helikopter Pilotu", "A≈üpaz", "T…ôhl√ºk…ôsizlik M√ºt…ôx…ôssisi"],
            "Kitabxana": ["Kitabxana√ßƒ±", "Alim", "M√ºhafiz…ô√ßi", "K…ô≈üfiyyat√ßƒ±", "Qadaƒüan Kitab Saxlayan"],
            "Robot S…ôrgisi": ["AI M√ºt…ôx…ôssisi", "Robot Dizayneri", "T…ôlim√ßi", "Jurnalist", "U≈üaq Ziyar…ôt√ßi"],
            "K…ônd T…ôs…ôrr√ºfatƒ± Yarmarkasƒ±": ["Fermer", "Traktor S√ºr√ºc√ºs√º", "Meyv…ô Eksperti", "Alver√ßi", "K…ôndli R…ôssam"],
            "Zombi Qa√ßqƒ±n D√º≈ü…ôrg…ôsi": ["H…ôkim", "M√ºhafiz…ô√ßi", "A≈üpaz", "K…ô≈üfiyyat√ßƒ±", "Virus T…ôdqiqat√ßƒ±"],
            "U√ßan Balon": ["Pilot", "Meteoroloq", "Turist", "Fotoreporter", "T…ômir√ßi"],        };

        let currentLocation, players = [], currentPlayerIndex = 0, spies = [];

        function getCurrentRolesSum() {
            return ['spyCount', 'jokerCount', 'detectiveCount'] // Use string IDs
                .map(id => parseInt(document.getElementById(id).value) || 0)
                .reduce((a, b) => a + b, 0);
        }

        function updatePlusButtonsState() {
            const maxSum = parseInt(document.querySelectorAll('.player-container').length) - 1;
            document.querySelectorAll('.count-btn.plus').forEach(btn => {
                const input = btn.parentElement.querySelector('.role-input');
                btn.disabled = getCurrentRolesSum() >= maxSum;
            });
        }

        // Player management
        function addPlayer() {
            const container = document.createElement('div');
            container.className = 'player-container';
            container.innerHTML = `
                <input class="player-input" placeholder="Oyun√ßu ${document.querySelectorAll('.player-container').length + 1}">
                <button class="remove-btn" onclick="removePlayer(this)">√ó</button>
            `;
            document.getElementById('nameInputs').appendChild(container);
            updateRemoveButtons();
            updatePlusButtonsState();
        }

        function removePlayer(btn) {
            if (document.querySelectorAll('.player-container').length <= 3) return;
            btn.parentElement.remove();
            updatePlaceholders();
            updateRemoveButtons();
            updatePlusButtonsState();
        }

        function updateRemoveButtons() {
            document.querySelectorAll('.remove-btn').forEach(btn => {
                btn.disabled = document.querySelectorAll('.player-container').length <= 3;
            });
        }

        // Game logic
        function startGame() {
            const totalPlayers = document.querySelectorAll('.player-container').length;
            const roleCounts = ['spyCount', 'jokerCount', 'detectiveCount']
                .map(id => parseInt(document.getElementById(id).value) || 0);
            
            if (roleCounts.reduce((a, b) => a + b, 0) >= totalPlayers) {
                alert("√áoxlu x√ºsusi rollar!");
                return;
            }

            players = Array.from(document.querySelectorAll('.player-input'))
                .map((input, i) => ({
                    name: input.value.trim() || `Oyun√ßu ${i + 1}`,
                    role: "",
                    isSpy: false,
                    knowsLocation: true,
                    knowsSpies: false
                }));

            currentLocation = Object.keys(locations)[Math.floor(Math.random() * Object.keys(locations).length)];
            spies = [];
            
            const roles = shuffleArray([
                ...Array(roleCounts[0]).fill('C…ôsus'),
                ...Array(roleCounts[1]).fill('Joker'),
                ...Array(roleCounts[2]).fill('X…ôfiyy…ô'),
                ...Array(totalPlayers - roleCounts.reduce((a, b) => a + b)).fill('V…ôt…ônda≈ü')
            ]);

            players = shuffleArray(players).map((p, i) => {
                const role = roles[i];
                if (role === 'Casus') spies.push(p.name);
                return {
                    ...p,
                    role,
                    isSpy: role === 'Casus',
                    knowsLocation: role !== 'Casus',
                    knowsSpies: role === 'Coker'
                };
            });

            showScreen('setup', false);
            showScreen('roleScreen', true);
            updateCurrentPlayerDisplay();
        }

        function showRole() {
            const player = players[currentPlayerIndex];
            const content = `Rol: <strong><span style="color: ${
                player.role === "C…ôsus" ? "red" : 
                player.role === "Joker" ? "orange" : 
                player.role === "X…ôfiyy…ô" ? "cyan" : "green"}">${player.role}</span></strong><br>
                
                ${player.knowsLocation ? `M…ôkan: <strong>${currentLocation}</strong><br>` : ''}
                ${player.knowsSpies ? `Casuslar: <strong><span style="color: red">${spies.join(', ')}</span></strong>` : ''}`;
            
            document.getElementById('overlayContent').innerHTML = content;
            document.getElementById('roleOverlay').style.display = 'flex';
            document.getElementById('nextBtn').style.display = 'block';
        }

        function nextPlayer() {
            if (++currentPlayerIndex >= players.length) startGamePhase();
            else updateCurrentPlayerDisplay();
            document.getElementById('nextBtn').style.display = 'none';
        }

        function startGamePhase() {
            showScreen('roleScreen', false);
            showScreen('gameScreen', true);
        }

        // Helper functions
        function shuffleArray(arr) {
            for (let i = arr.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [arr[i], arr[j]] = [arr[j], arr[i]];
            }
            return arr;
        }

        function updateCurrentPlayerDisplay() {
            document.getElementById('currentPlayerName').textContent = players[currentPlayerIndex].name;
        }

        function showScreen(id, visible) {
            document.getElementById(id).style.display = visible ? 'block' : 'none';
        }
        function hideOverlay() {
            document.getElementById('roleOverlay').style.display = 'none';
        }
        // Event listeners
        document.addEventListener('click', e => {
            if (e.target.classList.contains('count-btn')) {
                const input = e.target.parentElement.querySelector('.role-input');
                input.value = Math.max(input.min, 
                    parseInt(input.value) + (e.target.classList.contains('plus') ? 1 : -1)
                );
                updatePlusButtonsState();
            }
        });

        // Initialization
        ["Mahir", "Heyd…ôr", "Tural", "Aydan", "M√∂vlud", "Nicat", 
          "≈ûahmur", "Elb…ôy", "C…ômal…ôddin", "V√ºsal", "Ruhulla", "∆èyyub"].forEach((name, i) => {
            const container = document.createElement('div');
            container.className = 'player-container';
            container.innerHTML = `
                <input class="player-input" placeholder="Oyun√ßu ${document.querySelectorAll('.player-container').length + 1}">
                <button class="remove-btn" onclick="removePlayer(this)">√ó</button>
            `;
            document.getElementById('nameInputs').appendChild(container);
            document.querySelectorAll('.player-input')[i].value = name;
        });
        updateRemoveButtons();
        updatePlusButtonsState();
    </script>
</body>
</html>